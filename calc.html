<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graphic Calculator</title>
    <style>
        /* Your CSS styles remain unchanged */
    </style>
</head>
<body>
    <div class="calculator">
        <input type="text" id="expression" placeholder="Enter expression">
        <br>
        <!-- Button rows and other HTML elements remain unchanged -->
    </div>
    <div id="log"></div>

    <script>
        let base16Mode = false;

        function appendToExpression(value) {
            document.getElementById('expression').value += value;
        }

        function clearExpression() {
            document.getElementById('expression').value = '';
        }

        function toggleBase16() {
            base16Mode = !base16Mode;
            let logElement = document.getElementById('log');
            logElement.innerHTML += base16Mode ? 'Switched to Base16 mode;<br>' : 'Switched to Decimal mode;<br>';
            calculateExpression(); // Recalculate and update result on mode toggle
        }

        function calculateExpression() {
            let expression = document.getElementById('expression').value;
            let result;

            try {
                // If Base16 mode is active, replace hexadecimal values with decimal equivalents
                if (base16Mode) {
                    expression = expression.replace(/0x[0-9A-Fa-f]+/g, function(match) {
                        let hexValue = match.substring(2); // Extract the hexadecimal value
                        return parseInt(hexValue, 16); // Convert to decimal
                    });
                }

                result = eval(expression); // Evaluate the expression

                if (base16Mode) {
                    result = Math.floor(result).toString(16).toUpperCase(); // Convert result to base16 format
                    result = '0x' + result;
                }

                let resultDisplay = result !== undefined ? result : '';
                document.getElementById('expression').value = resultDisplay;
                document.getElementById('log').innerHTML = '=' + resultDisplay + ';<br>';
            } catch (error) {
                document.getElementById('expression').value = 'Error';
                document.getElementById('log').innerHTML = 'Error; ';
            }
        }
    </script>
</body>
</html>
